#--------------------------------------------------------
# Diccionario con biografías autores del Boom Latinoamericano

biografias_boom = {
    "Julio Cortázar": {
        "nacionalidad": "Argentina",
        "bio": """Julio Cortázar nació en 1914. Vivió con sus padres en Suiza hasta que se mudó a Buenos Aires a la edad de cuatro años.40​ Al igual que otros escritores del boom, Cortázar llegó a cuestionar la política de su país: su oposición a Juan Domingo Perón lo llevó a dejar su puesto de profesor en la Universidad Nacional de Cuyo y en última instancia, a su exilio.41​.
        En 1951 se trasladó a París, donde pasó la mayor parte de su vida profesional, y en 1981 se convirtió en ciudadano francés.42​ Como García Márquez, Cortázar apoyó al gobierno cubano de Fidel Castro, al presidente chileno Salvador Allende, y a otros movimientos de izquierda como los sandinistas en Nicaragua.42​
        Entre sus influencias se encuentran Jorge Luis Borges y Edgar Allan Poe.43​ Su obra más importante y la que lo catapultó al reconocimiento internacional, es la novela Rayuela, publicada en 1963.42​ Se compone de 155 capítulos, 99 de los cuales son «fungibles», que se pueden leer en varios pedidos de acuerdo a la predilección de los lectores.
        Sus otros trabajos incluyen colecciones de cuentos como Bestiario (1951), Final del juego (1956), Las armas secretas (1959) y Todos los fuegos el fuego (1966). También escribió novelas como Los premios (1960) y Libro de Manuel (1973), y el inclasificable Historias de cronopios y de famas (1962). Falleció en París el 12 de febrero de 1984.""",
        "obra_principal": "Rayuela",
        "fecha_publicacion": "1963",
        "vivo": False,
    },
    "Gabriel García Márquez": {
        "nacionalidad": "Colombia",
        "bio": """
        Gabriel García Márquez nació en Aracataca, Colombia, en 1927. Junto a Mario Vargas Llosa, ha sido quien mayor proyección internacional ha logrado entre los escritores del boom. Gabo, como también se le conocía, empezó como periodista y escribió muchos artículos y relatos cortos, que fueron publicados en el diario El Espectador de Bogotá.44​ Después de residir unos años en Europa, se instaló en la Ciudad de México en 1961, donde residió hasta su fallecimiento.
        Es conocido por novelas como El coronel no tiene quien le escriba (1962), Cien años de soledad (1967), El otoño del patriarca (1975), y post-boom, como El amor en los tiempos del cólera (1985), y por haber recibido el Premio Nobel de Literatura en 1982. Ha logrado elogios de la crítica y éxito comercial general, sobre todo por la introducción de lo que se ha denominado realismo mágico en el mundo literario. Narró con métodos tradicionales hechos más o menos ajenos a la realidad, de modo que «lo más espantoso, las cosas más insólitas se dicen con la expresión impasible».45​ Un ejemplo comúnmente citado es el físico y espiritual de ascender al cielo de un personaje, mientras que cuelga la ropa a secar en Cien años de soledad. Esta novela cumbre del escritor colombiano, según estudios actuales, modifica la percepción que tenemos del pasado y construye una nueva mirada sobre el futuro.46​ García Márquez es ahora considerado como uno de los autores más significativos del siglo XX, como lo atestigua el haber sido galardonado con el Premio Nobel de Literatura en 1982. Falleció en México D.F. el 17 de abril de 2014.47​
        El autor es considerado, junto con Álvaro Mutis, como un escritor que realizó desde su obra un valioso aporte desde las letras colombianas durante el período denominado boom latinoamericano que está fuertemente influenciado por la presencia de escritores mexicanos, de la talla de Carlos Fuentes y Juan Rulfo. A partir del concepto de campo literario es lícito afirmar que la escritura de autor de Cien años de soledad produjo profundas transformaciones en la literatura del siglo XX.48​
        """,
        "obra_principal": "Cien años de soledad",
        "fecha_publicacion": "1967",
        "vivo": False,
    },
    "Carlos Fuentes": {
        "nacionalidad": "México",
        "bio": """
        Nacido en Panamá de padres mexicanos, en 1928, Carlos Fuentes comenzó a publicar en la década de 1950.49​ Fue hijo de un diplomático mexicano y vivió en ciudades como Buenos Aires, Santiago, Quito, Montevideo y Río de Janeiro, así como Washington D. C..50​ Sus experiencias de lucha contra la discriminación de México en los Estados Unidos le llevó a examinar más de cerca la cultura mexicana.51​ Su novela La muerte de Artemio Cruz (1962) describe la vida de un ex revolucionario mexicano en su lecho de muerte, cambios innovadores que emplean en un punto de vista. Otros trabajos importantes incluyen La región más transparente (1959), Aura (1962), Terra Nostra (1975), y la novela post-boom Gringo Viejo (1985).
        Fuentes no solo escribió algunas de las novelas más importantes de la época, también fue un crítico y publicista de Latinoamérica. En 1955, Fuentes y Emmanuel Carballo fueron fundadores de la Revista Mexicana de Literatura, que introdujo los latinoamericanos a las obras modernistas de Europa y las ideas de Jean-Paul Sartre y Albert Camus.52​ En 1969 publicó la obra crítica importante, La nueva novela hispanoamericana. Fuentes ocupó el cargo de profesor de literatura latinoamericana en la Universidad de Columbia (1978) y en Harvard (1987).53​ En una ocasión dijo que «el llamado boom, en realidad, es el resultado de cuatro siglos, literariamente, llegado a un momento de urgencia en que la ficción se convirtió en la manera de organizar las lecciones del pasado».54​Falleció en México D.F. el 15 de mayo de 2012.
        """,
        "obra_principal": "La muerte de Artemio Cruz",
        "fecha_publicacion": "1962",
        "vivo": False,
    },

    "Mario Vargas Llosa": {
        "nacionalidad": "Perú",
        "bio": """
            Jorge Mario Pedro Vargas Llosa (Arequipa, 28 de marzo de 1936), conocido como Mario Vargas Llosa, es un escritor peruano que cuenta también con la nacionalidad española desde 1993. Considerado uno de los más importantes novelistas y ensayistas contemporáneos, sus obras han cosechado numerosos premios, entre los que destacan el Nobel de Literatura 2010, el Cervantes 1994 —considerado como el más importante en lengua española—, el Príncipe de Asturias de las Letras 1986, el Biblioteca Breve 1962, el Rómulo Gallegos 1967 y el Planeta 1993, entre otros.
            Como escritor, alcanzó la fama en la década de 1960 con novelas como La ciudad y los perros (1963), La casa verde (1966) y Conversación en La Catedral (1969). Continuó escribiendo prolíficamente en varios géneros literarios, como el ensayo, el artículo y el teatro. Varias de sus obras han sido adaptadas al cine y a la televisión. La mayoría de sus novelas están ambientadas en Perú y exploran su concepción sobre la sociedad peruana; en cambio, en La guerra del fin del mundo (1981), La fiesta del Chivo (2000) y El sueño del celta (2010), ubica sus tramas en otros países.
            """,
        "obra_principal": "La casa verde",
        "fecha_publicacion": "1966",
        "vivo": True,
    }}


#--------------------------------------------------------
# Funcion limpieza de textos - Cadena

def limpiar_texto_str(bio:str) -> str:
    caracteres_especiales = '.,(){}[]/\:;-'
    for caracter in caracteres_especiales:
        if caracter in bio:
            bio = bio.replace(caracter, ' ')
    return bio


#--------------------------------------------------------
# Funcion limpieza de textos - Diccionario

def limpiar_texto_dic(bios:dict) -> dict:
    caracteres_especiales = '.,(){}[]/\:;-'
    for caracter in caracteres_especiales:
        for autor in bios.keys():
            if caracter in bios[autor]['bio']:
                bios[autor]['bio'] = bios[autor]['bio'].replace(caracter, ' ')
    return bios


#--------------------------------------------------------
# Ejercicio 1 - Listado de Autores

def autores(bios:dict) -> list:
    """Devuelve una lista de autores de un diccionario de biografía tomando sus claves

    Parámetros
    ----------
    bios: dict
        Diccionario de biografías donde la clave es el autor.

    Retorna:
    -------
    autores: list
        Listado con los nombres de los autores.

    """
    autores = []

    for autor in bios.keys():
        autores.append(autor)
    
    return autores

#--------------------------------------------------------
# Ejercicio 2a - Extraer fechas de la entrada de biografía de un autor

def extraer_fechas(bios:dict, autor:str) -> dict:
    """ Extrae todos los años que tengan 4 cifras un diccionario donde las claves son el nombre de autores

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    
    autor: str
        Palabra clave para buscar la información de un autor.

    Retorno
    -------
    fechas: dict
        Diccionario que crea una clave con el nombre de cada autor con el valor de las fechas presentas en su biografía.
        Clave: Autor
        Valor: Fechas en la biografía
    """
 
    fechas = {}

    bios = limpiar_texto_dic(bios)

    for aut in bios.keys():
        if autor.lower() in aut.lower():
           
            fechas[aut] = []

            for palabra in bios[aut]['bio'].split():
                if palabra.isdigit() and len(palabra) == 4:
                    
                    fechas[aut].append(palabra)

    return fechas

#--------------------------------------------------------
# Ejercicio 2b - Extraer la fecha de nacimiento del autor

def fecha_nacimiento(bios:dict, autor:str ) -> dict:
    """ Extrae el primer año de 4 cifras de una cadena de texto en un diccionario.

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    
    autor: str
        Palabra clave para buscar la información de un autor.

    Retorno
    -------
    fecha_nac: dict
        Diccionario con los nombres y las fechas de nacimiento de los autores que coicidan con la palabra clave.
        Clave: Autor
        Valor: Fecha nacimiento
    """      
       
    fechas_nac = {}

    bios = limpiar_texto_dic(bios)

    for autor, fechas in extraer_fechas(bios, autor).items():
        fechas_nac[autor] = fechas[0]

    return fechas_nac

#--------------------------------------------------------
# Ejercicio 3a - Edad de los autores al publicar su obra más importante

def edad_publicacion(bios:dict, autor:str) -> dict:
    """ Calcula la edad de un autor al momento de su publicación más importante.

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    
    autor: str
        Palabra clave para buscar la información de un autor.

    Retorno
    -------
    fecha_nac: dict
        Diccionario con los nombres y las fechas de publicación de la obra más importante de los autores que coicidan con la palabra clave.
        Clave: Autor
        Valor: Edad autor
    """      
    
    bios = limpiar_texto_dic(bios)
    
    fechas_pub = {}

    for autor, fecha in fecha_nacimiento(bios,autor).items():
        fechas_pub[autor] = int(bios[autor]['fecha_publicacion'])- int(fecha)
 
    return fechas_pub


#--------------------------------------------------------
# Ejercicio 3b - Promedio de edades al publicar sus obras más importante

def edad_promedio(bios:dict, lista_autores:list) -> int:
    """ Calcula la edad promedio de los autores al momento de su publicación más importante.

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    lista_autores: list
        Listado con nombres o palabras clave de los autores.

    Retorno
    -------
    round(fechas_promedio_pub): int
        Edad promedio de los autores al publicar su obra más importante
    """      
    
    bios = limpiar_texto_dic(bios)
    
    fechas_pub = []

    for autor in lista_autores:
        for aut, pub in edad_publicacion(bios,autor).items():
            fechas_pub.append(pub)
    
    fechas_promedio_pub = sum(fechas_pub) / len(fechas_pub)

    return round(fechas_promedio_pub)


#--------------------------------------------------------
# Ejercicio 4a - Fecha de defunción de los autores

def fecha_defuncion(bios:dict, autor:str ) -> dict:
    """ Extrae el primer año de 4 cifras de una cadena de texto en un diccionario.

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    
    autor: str
        Palabra clave para buscar la información de un autor.

    Retorno
    -------
    fecha_defuncion_autor: dict
        Diccionario con los nombres y las fechas de nacimiento de los autores que coicidan con la palabra clave.
        Clave: Autor
        Valor: Fecha nacimiento
    """      
       
    fecha_defuncion_autor = {}

    bios = limpiar_texto_dic(bios)

    for autor, fechas in extraer_fechas(bios, autor).items():
        if bios[autor]['vivo'] == False:
            fecha_defuncion_autor[autor] = fechas[-1]
        else:
            fecha_defuncion_autor[autor] = None
    return fecha_defuncion_autor


#--------------------------------------------------------
# Ejercicio 4b - Edad de defunción de los autores

def edad_defuncion (bios:dict, autor:str) -> dict:
    """ Calcula la edad promedio de los autores al momento de su publicación más importante.

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    autor: strt
        Palabra clave para encontrar al autor en el diccionario.

    Retorno
    -------
    edades_defuncion: dict
        Edad de muerte del autor
        Clave: Autor
        Valor: Edad de la muerte o 'None' si esta vivo
    """      
    edades_defuncion = {}
    
    for autor,fecha in fecha_defuncion(bios,autor).items():
        if isinstance(fecha, str):
            edades_defuncion[autor] = int(fecha) - int(fecha_nacimiento(bios,autor)[autor])
        else:
            edades_defuncion[autor] = None
    
    return edades_defuncion


#--------------------------------------------------------
# Ejercicio 5a - Autor más longevo

def longevo(bio:dict, anio_actual:int, lista_autores:list) ->list:
    """ Define cual es el autor más longevo a la fecha.

    Parámetros
    ----------
    bios: dict
        Diccionario donde las claves son los nombres de los autores y los valores contienen subclaves con la nacionalidad, biografía, obra importante, fecha de publicación y si esta actualmente vivo.
    anio_actual: int
        Año presente para calcular la edad de los autores vivos.
    
    lista_autores: list
        Listado de palabras claves para encontrar autores en un diccionario.

    Retorno
    -------
    aut_longevo: list
        Listado de tuplas el o los autores más longevos. Cada elemento contiene el nombre, la edad y un valor booleano que indica si la persona está viva o no.
    """      
    
    edades_max = {}
    list_edades_max = []
    aut_longevo = []

    for aut in lista_autores:
        for autor, edad in edad_defuncion(bio, aut).items():
            if type(edad) == int:
                edades_max[autor] = {}
                edades_max[autor]['edad'] = edad
                edades_max[autor]['vivo'] = False
            else:
                edades_max[autor] = {}
                edades_max[autor]['edad'] = anio_actual - int(fecha_nacimiento(bio,aut)[autor])
                edades_max[autor]['vivo'] = True

    for a, e_v in edades_max.items(): 
        for e, v in e_v.items():
            edad = e_v['edad']
            vivo = e_v['vivo']
        list_edades_max.append((a,edad,vivo))
   

    list_edades_max = sorted(list_edades_max, key=lambda x: (x[1], x[2], x[0]), reverse=True)

    aut_longevo = [list_edades_max[0]]

    for a,e,v in list_edades_max:
        if e == list_edades_max[0][1] and a != list_edades_max[0][0]:
            aut_longevo.append((a,e,v))

    return aut_longevo


#--------------------------------------------------------
# Ejercicio 6 - Llamar todas la funciones

def main(bios:dict):
    """
    Esta función llama a las funciones que acabamos de crear.
    
    PARAMETROS:
    ----------
        diccionario_bios: diccionario con la información de los autores del boom latinoamericano
    
    RETORNA:
    -------
        None
    """     
    anio_actual = 2023

    print(f'Los autores del boom latinoamericano en el diccionario son {", ".join(autores(bios))}.')
    print()
    
    print('Los autores en el diccionario nacieron en los años:')
    for autor in autores(bios):
        for aut,nac in fecha_nacimiento(bios,autor).items():
            print('-' ,aut,':', nac)
    print()

    print('Las edades de los autores al publicar su obra más importante es:')
    for autor in autores(bios):
        for aut,nac in edad_publicacion(bios,autor).items():
            print('-' ,aut,':', nac)
    print()

    print(f'Los autores al publicar su obra más importante tenian una edad promedio de {edad_promedio(bios, autores(bios))} años.')
    print()

    print('Las fechas de fallecimiento de los autores es:')
    for autor in autores(bios):
        for aut,defun in fecha_defuncion(bios,autor).items():
            if type(defun) == int:
                print(f'- {aut}: {defun} con {edad_defuncion(bios, aut)[aut]} años.')
            else:
                print(f'- {aut}: No ha fallecido y tiene {anio_actual - int(fecha_nacimiento(bios, aut)[aut])} años.')
    print()

    print('El/Los autor(es) más longevos del boom latinoamericano es/son:')
    for aut, edad, vivo in longevo(bios, anio_actual,autores(bios)):
        if vivo == True:
            print(f'- {aut}: actualmente vivo con {edad}')
        else:
            print(f'- {aut}: murió con {edad}')


#--------------------------------------------------------
# Llamado función final

main(biografias_boom)